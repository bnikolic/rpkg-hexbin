magent <- function(n, beg = 1, end = 256)
{
    if(beg < 1 || end < 1 || beg > 256 || end > 256)
	stop("`beg' and `end' must be numbers in the interval [1,256]")

    M <- rbind(c(0,  0,	 0),
	       c( 40,  0,  0),
	       c( 56,  0,  4),
	       c( 61,  0,  9),
	       c( 64,  0, 12),
	       c( 66,  0, 14),
	       c( 69,  0, 17),
	       c( 73,  0, 20),
	       c( 74,  0, 22),
	       c( 78,  0, 25),
	       c( 79,  0, 27),
	       c( 83,  0, 30),
	       c( 85,  0, 31),
	       c( 86,  0, 33),
	       c( 90,  0, 36),
	       c( 91,  0, 38),
	       c( 93,  0, 39),
	       c( 95,  0, 41),
	       c( 96,  0, 43),
	       c(100,  0, 46),
	       c(102,  0, 47),
	       c(103,  0, 49),
	       c(105,  0, 51),
	       c(107,  0, 52),
	       c(108,  0, 54),
	       c(110,  0, 55),
	       c(112,  0, 57),
	       c(112,  0, 57),
	       c(113,  0, 58),
	       c(115,  0, 60),
	       c(117,  0, 62),
	       c(119,  0, 63),
	       c(120,  0, 65),
	       c(122,  0, 66),
	       c(124,  0, 68),
	       c(125,  0, 70),
	       c(127,  0, 71),
	       c(129,  0, 73),
	       c(129,  0, 73),
	       c(130,  0, 74),
	       c(132,  0, 76),
	       c(134,  0, 78),
	       c(136,  0, 79),
	       c(137,  0, 81),
	       c(139,  0, 82),
	       c(141,  0, 84),
	       c(142,  0, 86),
	       c(144,  0, 87),
	       c(146,  0, 89),
	       c(147,  0, 90),
	       c(149,  0, 92),
	       c(151,  0, 94),
	       c(151,  0, 94),
	       c(153,  0, 95),
	       c(154,  0, 97),
	       c(156,  0, 98),
	       c(158,  0,100),
	       c(159,  0,102),
	       c(161,  0,103),
	       c(163,  0,105),
	       c(164,  0,106),
	       c(166,  0,108),
	       c(168,  0,109),
	       c(170,  0,111),
	       c(171,  0,113),
	       c(173,  0,114),
	       c(175,  0,116),
	       c(176,  0,117),
	       c(178,  0,119),
	       c(180,  0,121),
	       c(180,  0,121),
	       c(181,  0,122),
	       c(183,  0,124),
	       c(185,  0,125),
	       c(187,  0,127),
	       c(188,  0,129),
	       c(190,  0,130),
	       c(192,  0,132),
	       c(193,  0,133),
	       c(195,  0,135),
	       c(197,  0,137),
	       c(198,  0,138),
	       c(200,  0,140),
	       c(202,  0,141),
	       c(204,  0,143),
	       c(204,  0,143),
	       c(205,  0,145),
	       c(207,  0,146),
	       c(209,  0,148),
	       c(210,  0,149),
	       c(212,  0,151),
	       c(214,  0,153),
	       c(215,  0,154),
	       c(217,  0,156),
	       c(219,  0,157),
	       c(221,  0,159),
	       c(222,  0,160),
	       c(222,  0,160),
	       c(224,  0,162),
	       c(226,  0,164),
	       c(227,  0,165),
	       c(229,  0,167),
	       c(231,  0,168),
	       c(232,  0,170),
	       c(234,  0,172),
	       c(236,  0,173),
	       c(238,  0,175),
	       c(238,  0,175),
	       c(239,  0,176),
	       c(241,  0,178),
	       c(243,  0,180),
	       c(244,  0,181),
	       c(246,  0,183),
	       c(248,  2,184),
	       c(249,  4,186),
	       c(249,  4,186),
	       c(249,  4,186),
	       c(251,  6,188),
	       c(251,  6,188),
	       c(253,  9,189),
	       c(253,  9,189),
	       c(255, 11,191),
	       c(255, 11,191),
	       c(255, 13,192),
	       c(255, 13,192),
	       c(255, 13,192),
	       c(255, 16,194),
	       c(255, 18,196),
	       c(255, 20,197),
	       c(255, 20,197),
	       c(255, 23,199),
	       c(255, 25,200),
	       c(255, 27,202),
	       c(255, 30,204),
	       c(255, 32,205),
	       c(255, 34,207),
	       c(255, 37,208),
	       c(255, 37,208),
	       c(255, 39,210),
	       c(255, 41,211),
	       c(255, 44,213),
	       c(255, 46,215),
	       c(255, 48,216),
	       c(255, 51,218),
	       c(255, 53,219),
	       c(255, 53,219),
	       c(255, 55,221),
	       c(255, 57,223),
	       c(255, 60,224),
	       c(255, 62,226),
	       c(255, 64,227),
	       c(255, 67,229),
	       c(255, 67,229),
	       c(255, 69,231),
	       c(255, 71,232),
	       c(255, 74,234),
	       c(255, 76,235),
	       c(255, 78,237),
	       c(255, 81,239),
	       c(255, 81,239),
	       c(255, 83,240),
	       c(255, 85,242),
	       c(255, 88,243),
	       c(255, 90,245),
	       c(255, 92,247),
	       c(255, 95,248),
	       c(255, 95,248),
	       c(255, 97,250),
	       c(255, 99,251),
	       c(255,102,253),
	       c(255,104,255),
	       c(255,106,255),
	       c(255,106,255),
	       c(255,108,255),
	       c(255,111,255),
	       c(255,113,255),
	       c(255,115,255),
	       c(255,115,255),
	       c(255,118,255),
	       c(255,120,255),
	       c(255,122,255),
	       c(255,122,255),
	       c(255,125,255),
	       c(255,127,255),
	       c(255,129,255),
	       c(255,129,255),
	       c(255,132,255),
	       c(255,134,255),
	       c(255,136,255),
	       c(255,136,255),
	       c(255,139,255),
	       c(255,141,255),
	       c(255,143,255),
	       c(255,143,255),
	       c(255,146,255),
	       c(255,148,255),
	       c(255,150,255),
	       c(255,150,255),
	       c(255,153,255),
	       c(255,155,255),
	       c(255,155,255),
	       c(255,157,255),
	       c(255,159,255),
	       c(255,159,255),
	       c(255,162,255),
	       c(255,164,255),
	       c(255,164,255),
	       c(255,166,255),
	       c(255,169,255),
	       c(255,171,255),
	       c(255,171,255),
	       c(255,173,255),
	       c(255,176,255),
	       c(255,176,255),
	       c(255,178,255),
	       c(255,180,255),
	       c(255,180,255),
	       c(255,183,255),
	       c(255,185,255),
	       c(255,185,255),
	       c(255,187,255),
	       c(255,190,255),
	       c(255,190,255),
	       c(255,192,255),
	       c(255,194,255),
	       c(255,197,255),
	       c(255,197,255),
	       c(255,199,255),
	       c(255,201,255),
	       c(255,204,255),
	       c(255,204,255),
	       c(255,206,255),
	       c(255,208,255),
	       c(255,210,255),
	       c(255,210,255),
	       c(255,213,255),
	       c(255,215,255),
	       c(255,217,255),
	       c(255,217,255),
	       c(255,220,255),
	       c(255,222,255),
	       c(255,224,255),
	       c(255,227,255),
	       c(255,229,255),
	       c(255,229,255),
	       c(255,231,255),
	       c(255,234,255),
	       c(255,236,255),
	       c(255,238,255),
	       c(255,241,255),
	       c(255,243,255),
	       c(255,243,255),
	       c(255,245,255),
	       c(255,248,255),
	       c(255,250,255),
	       c(255,255,255)) [ round(seq(beg,end,length = n)), ]

    rgb(M[,1]/255,
	M[,2]/255,
	M[,3]/255)
}
